<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.1.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.1.xsd">   
                         
	
	<import resource="classpath*:spring/applicationContext.xml"/>	
 	<context:component-scan base-package="${component.scan.package}"/> 
    <!-- 注解支持 -->
	<mvc:annotation-driven>
	    <mvc:message-converters register-defaults="true">
		    <bean class="com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter">  
		      <property name="supportedMediaTypes">
		      	<list>  
                    <value>text/html;charset=UTF-8</value>  
                    <value>application/json</value>  
                </list> 
		      </property>
		      <!--设置fastjson特性-->
		      <property name="features">
		        <array>
		          <!--设置null值也要输出，fastjson默认是关闭的-->
		          <value>WriteMapNullValue</value>
		          <!--设置使用文本方式输出日期，fastjson默认是long-->
		          <value>WriteDateUseDateFormat</value>
		        </array>
		      </property>
		    </bean>
	  </mvc:message-converters>
	</mvc:annotation-driven>
	<!-- <mvc:default-servlet-handler/> -->
	   <mvc:resources location="/img/" mapping="/img/**"/>        
        <mvc:resources location="/js/" mapping="/js/**"/>        
        <mvc:resources location="/css/" mapping="/css/**"/>
        <mvc:resources location="/fonts/" mapping="/fonts/**"/>      
     
	<!-- 配置freeMarker的模板路径 -->
	<bean id="freemarkerConfig" class="org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer">
	    <property name="templateLoaderPath">
	        <value>file://${authority.web.freemarker.dir}</value>
	    </property>
	    <property name="freemarkerVariables">
	        <map>
	            <entry key="xml_escape" value-ref="fmXmlEscape" />
	        </map>
	    </property>
	</bean>
	 
	<bean id="fmXmlEscape" class="freemarker.template.utility.XmlEscape"/>
	   
	<!-- 配置freeMarker视图解析器 -->
	<bean id="viewResolver" class="org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver">
	    <property name="viewClass" value="org.springframework.web.servlet.view.freemarker.FreeMarkerView"/>
	    <property name="contentType" value="text/html; charset=utf-8"/>
	    <property name="cache" value="true" />
	   <!--  <property name="prefix" value="" /> -->
	    <property name="suffix" value="${authority.web.view.template.suffix}" />
	    <property name="order" value="2"/>
	</bean>
	
	 <!-- SpringMVC上传文件时,需配置MultipartResolver处理器 -->  
    <bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">  
        <!-- 指定所上传文件的总大小不能超过800KB......注意maxUploadSize属性的限制不是针对单个文件,而是所有文件的容量之和 -->  
        <property name="maxUploadSize" value="${authority.web.upload.maxsize}"/>  
    </bean>  
      
    <!-- SpringMVC在超出上传文件限制时,会抛出org.springframework.web.multipart.MaxUploadSizeExceededException -->  
    <!-- 该异常是SpringMVC在检查上传的文件信息时抛出来的,而且此时还没有进入到Controller方法中 -->  
    <bean id="exceptionResolver" class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">  
        <property name="exceptionMappings">  
            <props>  
                <!-- 遇到MaxUploadSizeExceededException异常时,自动跳转到/WEB-INF/jsp/error_fileupload.jsp页面 -->  
                <prop key="org.springframework.web.multipart.MaxUploadSizeExceededException">${authority.web.upload.errorpage}</prop>  
            </props>  
        </property>  
    </bean>  
	
</beans>